#!/bin/bash
# CCB Zombie Sessions Cleaner

echo "ğŸ” æ£€æŸ¥åƒµå°¸ tmux sessions..."
ZOMBIE_COUNT=$(tmux list-sessions 2>/dev/null | grep -E "codex-|gemini-" | wc -l)

if [ "$ZOMBIE_COUNT" -eq 0 ]; then
    echo "âœ… æ²¡æœ‰åƒµå°¸ sessions"
    exit 0
fi

echo "âš ï¸  å‘ç° $ZOMBIE_COUNT ä¸ªåƒµå°¸ sessions"
tmux list-sessions 2>/dev/null | grep -E "codex-|gemini-" | head -10

read -p "æ˜¯å¦æ¸…ç†è¿™äº› sessions? (y/N) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    tmux list-sessions 2>/dev/null | grep -E "codex-|gemini-" | cut -d: -f1 | xargs -I {} tmux kill-session -t {}
    echo "âœ… å·²æ¸…ç†å®Œæˆ"
else
    echo "âŒ å·²å–æ¶ˆ"
fi
